<view class="container">
  <view class="header">
    <text class="title">{{gameName}}</text>
    <view class="level-info">
      <text>关卡: {{currentLevel}}/{{totalLevels}}</text>
    </view>
  </view>

  <view wx:if="{{currentTask}}" class="status-panel">
    <text class="status-text">当前任务: {{currentTask}}</text>
  </view>

  <view class="game-content">
    <block wx:if="{{gameType === 'linkedList'}}">
      <linked-list-game 
        nodes="{{nodes}}"
        currentLevel="{{currentLevel}}"
        bind:nodeTap="onNodeTap"
        bind:operation="onOperation"
        bind:complete="onLevelComplete"
      />
    </block>
    <block wx:elif="{{gameType === 'maze'}}">
      <maze-game 
        maze="{{maze}}"
        player="{{player}}"
        currentLevel="{{currentLevel}}"
        bind:move="onMove"
        bind:algorithm="onAlgorithmSelect"
        bind:complete="onLevelComplete"
      />
    </block>
    <block wx:elif="{{gameType === 'sorting'}}">
      <sorting-game 
        array="{{array}}"
        currentLevel="{{currentLevel}}"
        bind:sort="onSort"
        bind:algorithm="onAlgorithmSelect"
        bind:complete="onLevelComplete"
      />
    </block>
    <block wx:elif="{{gameType === 'binaryTree'}}">
      <binary-tree-game 
        tree="{{tree}}"
        currentLevel="{{currentLevel}}"
        bind:nodeSelect="onNodeSelect"
        bind:traversal="onTraversal"
        bind:complete="onLevelComplete"
      />
    </block>
    <block wx:elif="{{gameType === 'queue'}}">
      <queue-game 
        queue="{{queue}}"
        currentLevel="{{currentLevel}}"
        bind:enqueue="onEnqueue"
        bind:dequeue="onDequeue"
        bind:complete="onLevelComplete"
      />
    </block>
    <block wx:elif="{{gameType === 'graph'}}">
      <graph-game 
        graph="{{graph}}"
        currentLevel="{{currentLevel}}"
        bind:nodeSelect="onNodeSelect"
        bind:algorithmSelect="onAlgorithmSelect"
        bind:complete="onLevelComplete"
      />
    </block>
    
    <!-- 添加提示按钮 -->
    <view class="hint-button" bindtap="showHint">
      <text class="hint-icon">?</text>
    </view>
  </view>

  <view class="controls">
    <view class="operation-buttons" wx:if="{{operations.length > 0}}">
      <button 
        wx:for="{{operations}}" 
        wx:key="id"
        class="operation-btn"
        bindtap="onOperationTap"
        data-operation="{{item}}"
      >
        {{item.name}}
      </button>
    </view>
    <view class="navigation-buttons">
      <button 
        class="nav-btn prev" 
        bindtap="prevLevel"
        disabled="{{currentLevel === 1}}"
      >
        上一关
      </button>
      <button 
        class="nav-btn next" 
        bindtap="nextLevel"
        disabled="{{currentLevel === totalLevels || !levelCompleted}}"
      >
        下一关
      </button>
    </view>
  </view>

  <view class="hint-panel" wx:if="{{showHint}}">
    <text class="hint-text">{{currentHint}}</text>
    <button class="close-hint" bindtap="closeHint">关闭</button>
  </view>
</view> 